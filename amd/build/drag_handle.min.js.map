{"version":3,"file":"drag_handle.min.js","sources":["../src/drag_handle.js"],"sourcesContent":["import {BaseComponent, DragDrop} from 'core/reactive';\nimport { masterChecklistReactiveInstance } from 'mod_bookit/master_checklist_reactive';\nimport { SELECTORS } from 'mod_bookit/master_checklist_reactive';\n\nexport default class extends BaseComponent {\n\n    static init(target, selectors) {\n        return new this({\n            element: document.querySelector(target),\n            reactive: masterChecklistReactiveInstance,\n            selectors: selectors || SELECTORS,\n        });\n    }\n\n    stateReady() {\n        this.relativeDrag = true;\n\n        // this.dragdrop = new DragDrop(this);\n\n        const dragType = this.element.dataset.bookitDragHandleType;\n        const dragId = this.element.dataset.bookitDragHandleId;\n\n        // TODO fullregion needs to differentiate between type item & category\n\n        var fullRegionSelector = '';\n\n        switch (dragType) {\n            case 'item':\n                fullRegionSelector = `tr[data-bookit-drag-handle-${dragType}-id=\"${dragId}\"]`;\n                break;\n            case 'category':\n                fullRegionSelector = `tbody[data-bookit-tbody-category-id=\"${dragId}\"]`;\n                break;\n            default:\n                throw new Error(`Unknown drag handle type: ${dragType}`);\n        }\n\n        window.console.log('fullRegionSelector: ', fullRegionSelector);\n\n        const fullRegionElement = document.querySelector(fullRegionSelector);\n\n        window.console.log('DragDrop initialized for item: ', fullRegionElement);\n\n        window.console.log(this.element)\n\n        this.fullregion = fullRegionElement;\n\n        this.dragdrop = new DragDrop(this);\n    }\n\n    destroy() {\n        if (this.dragdrop !== undefined) {\n            this.dragdrop.unregister();\n        }\n    }\n\n    getDraggableData() {\n        const dragType = this.element.dataset.bookitDragHandleType;\n        var parentId = undefined;\n\n        switch (dragType) {\n            case 'item':\n                parentId = this.fullregion.dataset.bookitChecklistitemCategoryid;\n                break;\n            case 'category':\n                parentId = this.fullregion.dataset.bookitCategoryMasterid;\n                break;\n            default:\n                throw new Error(`Unknown drag handle type: ${dragType}`);\n        }\n\n        return {\n            id: this.element.dataset.bookitDragHandleId,\n            type: this.element.dataset.bookitDragHandleType,\n            parentId: parentId,\n        };\n    }\n\n    dragStart(dragData, event) {\n        // This method is called when the drag operation starts.\n        window.console.log('Drag started', dragData);\n    }\n\n    dragEnd(dragData, event) {\n        // This method is called when the drag operation ends.\n        window.console.log('Drag ended', dragData);\n    }\n\n    // validateDropData(dropdata) {\n\n    //     return true;\n    // }\n\n    // drop(dropdata, event) {\n    //     window.console.log('whoops you dropped this on a handle', dropdata);\n    // }\n}"],"names":["BaseComponent","target","selectors","this","element","document","querySelector","reactive","masterChecklistReactiveInstance","SELECTORS","stateReady","relativeDrag","dragType","dataset","bookitDragHandleType","dragId","bookitDragHandleId","fullRegionSelector","Error","window","console","log","fullRegionElement","fullregion","dragdrop","DragDrop","destroy","undefined","unregister","getDraggableData","parentId","bookitChecklistitemCategoryid","bookitCategoryMasterid","id","type","dragStart","dragData","event","dragEnd"],"mappings":"mQAI6BA,oCAEbC,OAAQC,kBACT,IAAIC,KAAK,CACZC,QAASC,SAASC,cAAcL,QAChCM,SAAUC,2DACVN,UAAWA,WAAaO,uCAIhCC,kBACSC,cAAe,QAIdC,SAAWT,KAAKC,QAAQS,QAAQC,qBAChCC,OAASZ,KAAKC,QAAQS,QAAQG,uBAIhCC,mBAAqB,UAEjBL,cACC,OACDK,wDAAmDL,yBAAgBG,uBAElE,WACDE,kEAA6DF,iCAGvD,IAAIG,0CAAmCN,WAGrDO,OAAOC,QAAQC,IAAI,uBAAwBJ,0BAErCK,kBAAoBjB,SAASC,cAAcW,oBAEjDE,OAAOC,QAAQC,IAAI,kCAAmCC,mBAEtDH,OAAOC,QAAQC,IAAIlB,KAAKC,cAEnBmB,WAAaD,uBAEbE,SAAW,IAAIC,mBAAStB,MAGjCuB,eAC0BC,IAAlBxB,KAAKqB,eACAA,SAASI,aAItBC,yBACUjB,SAAWT,KAAKC,QAAQS,QAAQC,yBAClCgB,cAAWH,SAEPf,cACC,OACDkB,SAAW3B,KAAKoB,WAAWV,QAAQkB,wCAElC,WACDD,SAAW3B,KAAKoB,WAAWV,QAAQmB,2CAG7B,IAAId,0CAAmCN,iBAG9C,CACHqB,GAAI9B,KAAKC,QAAQS,QAAQG,mBACzBkB,KAAM/B,KAAKC,QAAQS,QAAQC,qBAC3BgB,SAAUA,UAIlBK,UAAUC,SAAUC,OAEhBlB,OAAOC,QAAQC,IAAI,eAAgBe,UAGvCE,QAAQF,SAAUC,OAEdlB,OAAOC,QAAQC,IAAI,aAAce"}