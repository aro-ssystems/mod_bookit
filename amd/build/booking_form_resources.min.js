/**
 * Room-based resource filtering for booking form.
 *
 * @module     mod_bookit/booking_form_resources
 * @copyright  2026 ssystems GmbH <oss@ssystems.de>
 * @author     Andreas Rosenthal
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_bookit/booking_form_resources",[],(function(){function hideResource(groupElement){groupElement.style.display="none"}function updateCategoryVisibility(modalRoot){if(!modalRoot)return;modalRoot.querySelectorAll('fieldset[id*="id_header_cat_"]').forEach((fieldset=>{const resourceCheckboxes=fieldset.querySelectorAll("[data-resource-rooms]");let hasVisibleResource=!1;resourceCheckboxes.forEach((checkbox=>{"none"!==window.getComputedStyle(checkbox).display&&(hasVisibleResource=!0)})),fieldset.style.display=hasVisibleResource?"":"none"}))}function filterResourcesByRoom(modalRoot,selectedRoomId){if(!modalRoot)return;const roomId=parseInt(selectedRoomId,10);modalRoot.querySelectorAll("[data-resource-rooms]").forEach((group=>{const roomsJson=group.getAttribute("data-resource-rooms");if(roomsJson)try{const rooms=JSON.parse(roomsJson);Array.isArray(rooms)&&rooms.includes(roomId)?group.style.display="":hideResource(group)}catch(e){hideResource(group)}else hideResource(group)})),updateCategoryVisibility(modalRoot)}return{init:function(modalRoot){if(!modalRoot)return;const roomSelect=modalRoot.querySelector('select[name="roomid"]');if(!roomSelect)return;const resourceGroups=modalRoot.querySelectorAll("[data-resource-rooms]");resourceGroups.forEach((group=>hideResource(group))),updateCategoryVisibility(modalRoot),roomSelect.addEventListener("change",(function(){const selectedRoomId=this.value;selectedRoomId?filterResourcesByRoom(modalRoot,selectedRoomId):(resourceGroups.forEach((group=>hideResource(group))),updateCategoryVisibility(modalRoot))})),roomSelect.value&&filterResourcesByRoom(modalRoot,roomSelect.value)}}}));

//# sourceMappingURL=booking_form_resources.min.js.map