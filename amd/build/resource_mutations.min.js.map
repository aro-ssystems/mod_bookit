{"version":3,"file":"resource_mutations.min.js","sources":["../src/resource_mutations.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Mutations for resource catalog reactive state.\n *\n * @module mod_bookit/resource_mutations\n * @copyright   2026 ssystems GmbH <oss@ssystems.de>\n * @author      Andreas Rosenthal\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport default class {\n    /**\n     * Placeholder method for resource catalog state events.\n     */\n    resourceCatalogStateEvent() {\n        // This method is intentionally empty - it's a placeholder for state events.\n    }\n\n    /**\n     * Handle category updated (called by processUpdates for action: 'put').\n     *\n     * @param {Object} stateManager - The reactive state manager\n     * @param {Object} data - Data with fields object\n     */\n    categoriesUpdated(stateManager, data) {\n        const state = stateManager.state;\n\n        stateManager.setReadOnly(false);\n\n        state.categories.set(data.fields.id, {\n            id: data.fields.id,\n            name: data.fields.name,\n            description: data.fields.description,\n            sortorder: data.fields.sortorder,\n        });\n\n        stateManager.setReadOnly(true);\n    }\n\n    /**\n     * Handle category deletion (called by processUpdates for action: 'delete').\n     *\n     * @param {Object} stateManager - The reactive state manager\n     * @param {Object} data - Data with fields object containing id\n     */\n    categoriesDeleted(stateManager, data) {\n        const state = stateManager.state;\n\n        stateManager.setReadOnly(false);\n\n        // Delete all items in this category first\n        const itemsToDelete = [];\n        state.items.forEach((item, id) => {\n            if (item.categoryid === data.fields.id) {\n                itemsToDelete.push(id);\n            }\n        });\n        itemsToDelete.forEach(id => state.items.delete(id));\n\n        // Delete the category\n        state.categories.delete(data.fields.id);\n\n        stateManager.setReadOnly(true);\n    }\n\n    /**\n     * Handle item updated (called by processUpdates for action: 'put').\n     *\n     * @param {Object} stateManager - The reactive state manager\n     * @param {Object} data - Data with fields object\n     */\n    itemsUpdated(stateManager, data) {\n        const state = stateManager.state;\n\n        stateManager.setReadOnly(false);\n\n        state.items.set(data.fields.id, {\n            id: data.fields.id,\n            name: data.fields.name,\n            description: data.fields.description,\n            categoryid: data.fields.categoryid,\n            amount: data.fields.amount,\n            amountirrelevant: data.fields.amountirrelevant,\n            sortorder: data.fields.sortorder,\n            active: data.fields.active,\n        });\n\n        stateManager.setReadOnly(true);\n    }\n\n    /**\n     * Handle item deletion (called by processUpdates for action: 'delete').\n     *\n     * @param {Object} stateManager - The reactive state manager\n     * @param {Object} data - Data with fields object containing id\n     */\n    itemsDeleted(stateManager, data) {\n        const state = stateManager.state;\n\n        stateManager.setReadOnly(false);\n\n        state.items.delete(data.fields.id);\n\n        stateManager.setReadOnly(true);\n    }\n}\n"],"names":["resourceCatalogStateEvent","categoriesUpdated","stateManager","data","state","setReadOnly","categories","set","fields","id","name","description","sortorder","categoriesDeleted","itemsToDelete","items","forEach","item","categoryid","push","delete","itemsUpdated","amount","amountirrelevant","active","itemsDeleted"],"mappings":";;;;;;;;;MA4BIA,6BAUAC,kBAAkBC,aAAcC,YACtBC,MAAQF,aAAaE,MAE3BF,aAAaG,aAAY,GAEzBD,MAAME,WAAWC,IAAIJ,KAAKK,OAAOC,GAAI,CACjCA,GAAIN,KAAKK,OAAOC,GAChBC,KAAMP,KAAKK,OAAOE,KAClBC,YAAaR,KAAKK,OAAOG,YACzBC,UAAWT,KAAKK,OAAOI,YAG3BV,aAAaG,aAAY,GAS7BQ,kBAAkBX,aAAcC,YACtBC,MAAQF,aAAaE,MAE3BF,aAAaG,aAAY,SAGnBS,cAAgB,GACtBV,MAAMW,MAAMC,SAAQ,CAACC,KAAMR,MACnBQ,KAAKC,aAAef,KAAKK,OAAOC,IAChCK,cAAcK,KAAKV,OAG3BK,cAAcE,SAAQP,IAAML,MAAMW,MAAMK,OAAOX,MAG/CL,MAAME,WAAWc,OAAOjB,KAAKK,OAAOC,IAEpCP,aAAaG,aAAY,GAS7BgB,aAAanB,aAAcC,YACjBC,MAAQF,aAAaE,MAE3BF,aAAaG,aAAY,GAEzBD,MAAMW,MAAMR,IAAIJ,KAAKK,OAAOC,GAAI,CAC5BA,GAAIN,KAAKK,OAAOC,GAChBC,KAAMP,KAAKK,OAAOE,KAClBC,YAAaR,KAAKK,OAAOG,YACzBO,WAAYf,KAAKK,OAAOU,WACxBI,OAAQnB,KAAKK,OAAOc,OACpBC,iBAAkBpB,KAAKK,OAAOe,iBAC9BX,UAAWT,KAAKK,OAAOI,UACvBY,OAAQrB,KAAKK,OAAOgB,SAGxBtB,aAAaG,aAAY,GAS7BoB,aAAavB,aAAcC,YACjBC,MAAQF,aAAaE,MAE3BF,aAAaG,aAAY,GAEzBD,MAAMW,MAAMK,OAAOjB,KAAKK,OAAOC,IAE/BP,aAAaG,aAAY"}