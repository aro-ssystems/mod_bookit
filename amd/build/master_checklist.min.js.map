{"version":3,"file":"master_checklist.min.js","sources":["../src/master_checklist.js"],"sourcesContent":["import {BaseComponent} from 'core/reactive';\nimport {masterChecklistReactiveInstance} from 'mod_bookit/master_checklist_reactive';\nimport {SELECTORS} from 'mod_bookit/master_checklist_reactive';\nimport ModalForm from 'core_form/modalform';\nimport Templates from 'core/templates';\nimport * as Toast from 'core/toast';\nimport {getString} from 'core/str';\nimport Ajax from 'core/ajax';\nimport ChecklistHelper from 'mod_bookit/checklist_helper';\n\nexport default class extends BaseComponent {\n\n    static getEvents() {\n        return {\n            categoryRendered: 'mod_bookit:master_checklist_category_rendered',\n        };\n    }\n\n    static init(target, selectors) {\n        return new this({\n            element: document.querySelector(target),\n            reactive: masterChecklistReactiveInstance,\n            selectors: selectors || SELECTORS,\n        });\n    }\n\n    create() {\n        this.helper = new ChecklistHelper();\n    }\n\n    getWatchers() {\n        return [\n            {watch: 'checklistcategories:created', handler: this._handleCategoryCreatedEvent},\n            {watch: 'checklistcategories:deleted', handler: this._handleCategoryDeletedEvent},\n            {watch: 'checklistcategories.name:updated', handler: this._handleCategoryNameUpdatedEvent},\n            {watch: 'checklistcategories.items:updated', handler: this._handleCategoryItemsUpdatedEvent},\n            {watch: 'checklistitems:created', handler: this._handleItemCreatedEvent},\n            {watch: 'checklistitems:deleted', handler: this._handleItemDeletedEvent},\n            {watch: 'checklistitems.categoryid:updated', handler: this._handleItemCategoryUpdatedEvent},\n            {watch: 'checklistitems.title:updated', handler: this._replaceRenderedItem},\n            {watch: 'checklistitems.roomids:updated', handler: this._replaceRenderedItem},\n            {watch: 'checklistitems.roleid:updated', handler: this._replaceRenderedItem},\n            // {watch: 'activeRole:updated', handler: this._handleRoleUpdate},\n            // {watch: 'activeRoom:updated', handler: this._handleRoomUpdate},\n        ];\n    }\n\n    stateReady(state) {\n\n        const name = state.masterchecklists.get(1).name;\n\n        const titleElement = this.getElement(this.selectors.MASTER_CHECKLIST_TITLE);\n\n        titleElement.innerHTML = name;\n\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_ITEM_BUTTON), 'click', (e) => {\n            e.preventDefault();\n            this._handleAddChecklistItemButtonClick(e);\n        });\n\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_CATEGORY_BUTTON), 'click', (e) => {\n            e.preventDefault();\n            this._handleAddChecklistCategoryButtonClick(e);\n        });\n\n        this.addEventListener(this.getElement(this.selectors.ROLE_SELECT), 'change', (e) => {\n            this.reactive.dispatch('roleChanged', {id: e.target.value});\n        });\n        this.addEventListener(this.getElement(this.selectors.ROOM_SELECT), 'change', (e) => {\n            this.reactive.dispatch('roomChanged', {id: e.target.value});\n        });\n\n    }\n\n    async _handleAddChecklistItemButtonClick() {\n        const modalForm = new ModalForm({\n            formClass: \"mod_bookit\\\\form\\\\edit_checklistitem_form\",\n            args: {\n                masterid: 1,\n                itemid: null,\n                categories: Array.from(this.reactive.state.checklistcategories.values()),\n            },\n            modalConfig: {\n                title: await getString('checklistitem', 'mod_bookit'),\n            },\n\n        });\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\n            this.reactive.dispatch('checklistitemCreated', response.detail);\n        });\n\n        modalForm.show();\n    }\n\n    async _handleAddChecklistCategoryButtonClick() {\n        const modalForm = new ModalForm({\n            formClass: \"mod_bookit\\\\form\\\\edit_checklist_category_form\",\n            args: {\n                masterid: 1\n            },\n            modalConfig: {\n                title: await getString('checklistcategory', 'mod_bookit'),\n            },\n        });\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\n            this.reactive.stateManager.processUpdates(response.detail);\n\n        });\n\n        modalForm.show();\n    }\n\n    _handleCategoryCreatedEvent(event) {\n        Templates.renderForPromise('mod_bookit/bookit_checklist_category',\n            {\n                id: event.element.id,\n                name: event.element.name,\n                order: event.element.order,\n                masterid: 1, // TODO get from state\n                type: 'category',\n            })\n            .then(({html, js}) => {\n                Templates.appendNodeContents(this.getElement(this.selectors.TABLE), html, js);\n            })\n            .then(async () => {\n                Toast.add(await getString('checklistcategorysuccess', 'mod_bookit'),\n                    {type: 'success'});\n            })\n            .catch(error => {\n                window.console.error('Error rendering checklist item:', error);\n            });\n    }\n\n    _handleItemCreatedEvent(event) {\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.category}`);\n\n        const roomNames = [];\n        if (event.element.roomnames) {\n            Object.entries(event.element.roomnames).forEach(([key, value]) => {\n                roomNames.push({\n                    'roomid': key,\n                    'roomname': value\n                });\n            });\n        }\n\n        Templates.renderForPromise('mod_bookit/bookit_checklist_item',\n            {\n                id: event.element.id,\n                title: event.element.title,\n                order: event.element.order,\n                categoryid: event.element.category,\n                roomids: event.element.roomids,\n                roomnames: roomNames,\n                roleid: event.element.roleid,\n                rolename: event.element.rolename,\n                type: 'item',\n            })\n            .then(({html, js}) => {\n                Templates.appendNodeContents(targetElement, html, js);\n            })\n            .then(async () => {\n                Toast.add(await getString('checklistitemsuccess', 'mod_bookit'),\n                    {type: 'success'});\n            })\n            .catch(error => {\n                window.console.error('Error rendering checklist item:', error);\n            });\n    }\n\n    _handleItemDeletedEvent(event) {\n        const targetElement = this.getElement(`#bookit-master-checklist-item-${event.element.id}`);\n        targetElement.remove();\n\n        Toast.add(getString('checklistitemdeleted', 'mod_bookit', {title: event.element.title}),\n            {type: 'success'});\n    }\n\n    _replaceRenderedItem(event) {\n\n        window.console.log('REPLACING RENDERED ITEM: ', event);\n\n        const actionParts = event.action.split('.');\n        const fieldPart = actionParts[1].split(':')[0];\n\n        const elementSelector = `span[data-bookit-checklistitem-tabledata-${fieldPart}-id=\"${event.element.id}\"]`;\n\n        window.console.log('ELEMENT SELECTOR: ', elementSelector);\n\n        const targetElement = this.getElement(elementSelector);\n\n        window.console.log('TARGET ELEMENT: ', targetElement);\n\n        if (fieldPart.endsWith('id')) {\n            const nameField = fieldPart.substring(0, fieldPart.length - 2) + 'name';\n\n            if (nameField in event.element) {\n                targetElement.innerHTML = event.element[nameField];\n            }\n        } else if (fieldPart.endsWith('ids')) {\n\n            const stateItem = this.reactive.state.checklistitems.get(event.element.id);\n\n            // Convert roomnames object to array with roomid and roomname properties\n            const itemRooms = [];\n            if (stateItem.roomnames) {\n                Object.entries(stateItem.roomnames).forEach(([id, name]) => {\n                    itemRooms.push({\n                        'roomid': parseInt(id),\n                        'roomname': name\n                    });\n                });\n            }\n\n            const roomsSelector = `td[data-bookit-checklistitem-tabledata-${fieldPart}-id=\"${event.element.id}\"]`;\n            const roomsElement = this.getElement(roomsSelector);\n\n            window.console.log('ITEM ROOMS: ', itemRooms);\n\n            Templates.renderForPromise('mod_bookit/bookit_checklist_item_rooms',\n            {\n                roomnames: itemRooms\n            })\n            .then(({html, js}) => {\n                Templates.replaceNode(roomsElement, html, js);\n\n            })\n            .then(async () => {\n                Toast.add(await getString('checklistitemupdatesuccess', 'mod_bookit'),\n                    {type: 'success'});\n                    // this.dispatchEvent(this.events.categoryRendered, {\n                    //     categoryId: event.element.id\n                    // });\n            })\n            .catch(error => {\n                window.console.error('Error rendering checklist category:', error);\n            });\n            // var elementString = event.element[fieldPart];\n\n            // let roomIds = [];\n\n            // if (elementString.includes(',')) {\n            //     roomIds = elementString.split(',').map(id => parseInt(id));\n            // } else if (elementString !== '') {\n            //     roomIds = [parseInt(elementString)];\n            // }\n\n            // const roomNames = [];\n            // if (roomIds.length > 0) {\n            //     roomIds.forEach(roomId => {\n            //         if (event.element.roomnames[roomId]) {\n            //             roomNames.push(event.element.roomnames[roomId]);\n            //         }\n            //     });\n            //     // targetElement.innerHTML = roomNames.join(', ');\n            // }\n\n        } else {\n            targetElement.innerHTML = event.element[fieldPart];\n        }\n\n    }\n\n    _handleItemCategoryUpdatedEvent(event) {\n        const itemObject = this.reactive.state.checklistitems.get(event.element.id);\n\n        const formDataObj = {\n            itemid: itemObject.id,\n            masterid: 1,\n            title: itemObject.title,\n            categoryid: itemObject.categoryid,\n            roomid: itemObject.roomid,\n            roleid: itemObject.roleid,\n            action: 'put',\n            _qf__mod_bookit_form_edit_checklistitem_form: 1,\n        };\n\n        const formData = new URLSearchParams(formDataObj).toString();\n        // TODO move to mutation\n        Ajax.call([{\n            methodname: 'core_form_dynamic_form',\n            args: {\n                formdata: formData,\n                form: 'mod_bookit\\\\form\\\\edit_checklistitem_form'\n            }\n            }])[0]\n            .then((response) => {\n                // TODO handle response?\n                })\n                .catch(exception => {\n                    window.console.error('AJAX error:', exception);\n                });\n\n    }\n\n    _handleCategoryDeletedEvent(event) {\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.id}`);\n\n        targetElement.remove();\n\n        Toast.add(getString('checklistcategorydeleted', 'mod_bookit', {name: event.element.name}),\n            {type: 'success'});\n    }\n\n    _handleCategoryNameUpdatedEvent(event) {\n        const targetElement = this.getElement(`#bookit-master-checklist-category-row-${event.element.id}`);\n\n        Templates.renderForPromise('mod_bookit/bookit_checklist_category_row',\n            {\n                id: event.element.id,\n                name: event.element.name,\n                order: event.element.order,\n            })\n            .then(({html, js}) => {\n                Templates.replaceNode(targetElement, html, js);\n\n            })\n            .then(async () => {\n                Toast.add(await getString('checklistcategoryupdatesuccess', 'mod_bookit'),\n                    {type: 'success'});\n                    this.dispatchEvent(this.events.categoryRendered, {\n                        categoryId: event.element.id\n                    });\n            })\n            .catch(error => {\n                window.console.error('Error rendering checklist category:', error);\n            });\n\n    }\n\n    _handleCategoryItemsUpdatedEvent(event) {\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.id}`);\n\n        const category = this.reactive.state.checklistcategories.get(event.element.id);\n\n        const formDataObj = {\n            id: category.id,\n            masterid: 1,\n            name: category.name,\n            checklistitems: category.items,\n            action: 'put',\n            _qf__mod_bookit_form_edit_checklist_category_form: 1,\n        };\n\n        const formData = new URLSearchParams(formDataObj).toString();\n        // TODO move to mutation\n        Ajax.call([{\n            methodname: 'core_form_dynamic_form',\n            args: {\n                formdata: formData,\n                form: 'mod_bookit\\\\form\\\\edit_checklist_category_form'\n            }\n        }])[0]\n        .then((response) => {\n            // TODO handle response?\n        })\n        .catch(exception => {\n            window.console.error('AJAX error:', exception);\n\n        });\n    }\n\n    _handleRoleUpdate(event) {\n        const allCategoryElements = document.querySelectorAll(this.selectors.ALL_CATEGORY_TABLE_ROWS);\n        allCategoryElements.forEach(categoryElement => {\n\n            const category = this.reactive.state.checklistcategories.get(categoryElement.dataset.bookitCategoryId);\n            const items = [...category.items];\n            var hasVisibleItems = false;\n\n            const activeRoom = this.reactive.state.activeRoom.id;\n\n            items.forEach(itemId => {\n\n                // TODO fix rooms\n\n                const itemElement = document.querySelector(`tr[data-bookit-checklistitem-id=\"${itemId}\"]`);\n\n                if (activeRoom === 0) {\n\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id ||  event.element.id === 0) {\n                        itemElement.classList.remove('d-none');\n                        if (!hasVisibleItems) {\n                            hasVisibleItems = true;\n                        }\n                    } else {\n                        itemElement.classList.add('d-none');\n                    }\n                } else if (activeRoom === parseInt(itemElement.dataset.bookitChecklistitemRoom)) {\n\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id || event.element.id === 0) {\n                        itemElement.classList.remove('d-none');\n                        if (!hasVisibleItems) {\n                            hasVisibleItems = true;\n                        }\n                    } else {\n                        itemElement.classList.add('d-none');\n                    }\n                } else {\n\n                    itemElement.classList.add('d-none');\n                }\n            });\n\n            if (!hasVisibleItems) {\n                categoryElement.classList.add('d-none');\n            } else {\n                categoryElement.classList.remove('d-none');\n            }\n\n        });\n\n    }\n\n    _handleRoomUpdate(event) {\n\n        const allCategoryElements = document.querySelectorAll(this.selectors.ALL_CATEGORY_TABLE_ROWS);\n        allCategoryElements.forEach(categoryElement => {\n\n            const category = this.reactive.state.checklistcategories.get(categoryElement.dataset.bookitCategoryId);\n\n            const items = [...category.items];\n\n            var hasVisibleItems = false;\n\n            const activeRole = this.reactive.state.activeRole.id;\n\n            // items.forEach(itemId => {\n\n            //     const stateItem = this.reactive.state.checklistitems.get(itemId);\n\n            //     var isInRoom = false;\n\n            //     const roomIds = stateItem.roomids;\n\n            //     if (roomIds.includes(event.element.id.toString())) {\n            //         isInRoom = true;\n            //         window.console.log('ITEM IS IN ROOM: ', itemId);\n            //     } else {\n            //         window.console.log('ITEM IS NOT IN ROOM: ', itemId);\n            //     }\n\n            //     const itemElement = document.querySelector(`tr[data-bookit-checklistitem-id=\"${itemId}\"]`);\n\n            //     if (isInRoom) {\n            //         if (activeRole === 0 || parseInt(itemElement.dataset.bookitChecklistitemRole) === activeRole) {\n            //             itemElement.classList.remove('d-none');\n            //             if (!hasVisibleItems) {\n            //                 hasVisibleItems = true;\n            //             }\n            //         } else {\n            //             itemElement.classList.add('d-none');\n            //         }\n            //     } else {\n\n            //         if (event.element.id === 0 &&\n            //             (parseInt(itemElement.dataset.bookitChecklistitemRole) === activeRole || activeRole === 0)) {\n            //             itemElement.classList.remove('d-none');\n            //             if (!hasVisibleItems) {\n            //                 hasVisibleItems = true;\n            //             }\n            //         } else {\n            //             itemElement.classList.add('d-none');\n            //         }\n            //     }\n            // });\n\n            // if (!hasVisibleItems) {\n            //     categoryElement.classList.add('d-none');\n            // } else {\n            //     categoryElement.classList.remove('d-none');\n            // }\n\n        });\n    }\n\n}"],"names":["BaseComponent","categoryRendered","target","selectors","this","element","document","querySelector","reactive","masterChecklistReactiveInstance","SELECTORS","create","helper","ChecklistHelper","getWatchers","watch","handler","_handleCategoryCreatedEvent","_handleCategoryDeletedEvent","_handleCategoryNameUpdatedEvent","_handleCategoryItemsUpdatedEvent","_handleItemCreatedEvent","_handleItemDeletedEvent","_handleItemCategoryUpdatedEvent","_replaceRenderedItem","stateReady","state","name","masterchecklists","get","getElement","MASTER_CHECKLIST_TITLE","innerHTML","addEventListener","ADD_CHECKLIST_ITEM_BUTTON","e","preventDefault","_handleAddChecklistItemButtonClick","ADD_CHECKLIST_CATEGORY_BUTTON","_handleAddChecklistCategoryButtonClick","ROLE_SELECT","dispatch","id","value","ROOM_SELECT","modalForm","ModalForm","formClass","args","masterid","itemid","categories","Array","from","checklistcategories","values","modalConfig","title","events","FORM_SUBMITTED","response","detail","show","stateManager","processUpdates","event","renderForPromise","order","type","then","_ref","html","js","appendNodeContents","TABLE","async","Toast","add","catch","error","window","console","targetElement","category","roomNames","roomnames","Object","entries","forEach","_ref2","key","push","categoryid","roomids","roleid","rolename","_ref3","remove","log","fieldPart","action","split","elementSelector","endsWith","nameField","substring","length","stateItem","checklistitems","itemRooms","_ref4","parseInt","roomsSelector","roomsElement","_ref5","replaceNode","itemObject","formDataObj","roomid","_qf__mod_bookit_form_edit_checklistitem_form","formData","URLSearchParams","toString","call","methodname","formdata","form","exception","_ref6","dispatchEvent","categoryId","items","_qf__mod_bookit_form_edit_checklist_category_form","_handleRoleUpdate","querySelectorAll","ALL_CATEGORY_TABLE_ROWS","categoryElement","dataset","bookitCategoryId","hasVisibleItems","activeRoom","itemId","itemElement","bookitChecklistitemRole","classList","bookitChecklistitemRoom","_handleRoomUpdate","activeRole"],"mappings":"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"}