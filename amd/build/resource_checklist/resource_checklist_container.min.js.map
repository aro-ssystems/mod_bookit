{"version":3,"file":"resource_checklist_container.min.js","sources":["../../src/resource_checklist/resource_checklist_container.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Resource checklist container component.\n *\n * @module mod_bookit/resource_checklist/resource_checklist_container\n * @copyright   2026 ssystems GmbH <oss@ssystems.de>\n * @author      Andreas Rosenthal\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {Reactive} from 'core/reactive';\nimport BaseChecklistContainer from 'mod_bookit/checklist/base_checklist_container';\nimport ResourceChecklistMutations from './resource_checklist_mutations';\nimport {initializeFromDOM} from 'mod_bookit/checklist/checklist_helper';\nimport ResourceChecklistCategory from './resource_checklist_category';\n\nconst EVENTNAME = 'mod_bookit:resource_checklist_state_event';\nlet resourceChecklistReactiveInstance = null;\n\n/**\n * Dispatch the resource checklist state event.\n *\n * @param {Object} detail - The event detail\n * @param {HTMLElement} target - The target element\n */\nfunction dispatchResourceChecklistStateEvent(detail, target) {\n    if (target === undefined) {\n        target = document;\n    }\n    target.dispatchEvent(\n        new CustomEvent(\n            EVENTNAME,\n            {\n                bubbles: true,\n                detail: detail,\n            }\n        )\n    );\n}\n\n/**\n * Resource checklist container component.\n */\nexport default class extends BaseChecklistContainer {\n    /**\n     * Static init method.\n     *\n     * @param {string} target - CSS selector for container element\n     * @return {Object} Component instance\n     */\n    static init(target) {\n        const element = document.querySelector(target);\n        if (!element) {\n            return null;\n        }\n\n        // Initialize from DOM\n        const data = initializeFromDOM(element, {\n            categoryRegion: 'resource-checklist-category',\n            itemRegion: 'resource-checklist-item-row',\n            itemFields: {\n                resourceid: 'itemResourceid',\n                duedate: (el) => el.dataset.itemDuedate ? parseInt(el.dataset.itemDuedate) : null,\n                duedatetype: 'itemDuedatetype',\n                active: (el) => el.dataset.itemActive === '1',\n            }\n        });\n\n        // Initialize reactive WITHOUT setting state yet\n        if (!resourceChecklistReactiveInstance) {\n            resourceChecklistReactiveInstance = new Reactive({\n                name: 'Moodle Bookit Resource Checklist',\n                eventName: 'mod_bookit:resource_checklist_state_event',\n                eventDispatch: dispatchResourceChecklistStateEvent,\n                mutations: new ResourceChecklistMutations(),\n            });\n        }\n\n        // Create component FIRST so it registers for stateReady\n        const instance = new this({\n            element: element,\n            reactive: resourceChecklistReactiveInstance,\n        });\n\n        // Set state AFTER component is registered\n        resourceChecklistReactiveInstance.setInitialState({\n            categories: data.categories,\n            checklistitems: data.items,\n        });\n\n        return instance;\n    }\n\n    /**\n     * Component descriptor for debugging.\n     *\n     * @return {string} Component name\n     */\n    static get componentName() {\n        return 'mod_bookit/resource_checklist/resource_checklist_container';\n    }\n\n    /**\n     * Get configuration object.\n     *\n     * @return {Object} Configuration\n     */\n    getConfig() {\n        return {\n            categoriesStateKey: 'categories',\n            itemsStateKey: 'checklistitems',\n            itemType: 'checklistitem',\n            categoryRegion: 'resource-checklist-category',\n            itemRegion: 'resource-checklist-item-row',\n            categoryModalForm: 'mod_bookit\\\\form\\\\edit_category_form',\n            itemModalForm: 'mod_bookit\\\\form\\\\edit_resource_checklist_item_form',\n            selectors: {\n                addCategoryBtn: '#add-category-btn',\n                addItemBtn: '#add-checklist-item-btn',\n                tableView: '#resource-checklist-table-view',\n            }\n        };\n    }\n\n    /**\n     * Get category component class.\n     *\n     * @return {Class} Category component class\n     */\n    getCategoryComponent() {\n        return ResourceChecklistCategory;\n    }\n}\n"],"names":["resourceChecklistReactiveInstance","dispatchResourceChecklistStateEvent","detail","target","undefined","document","dispatchEvent","CustomEvent","bubbles","BaseChecklistContainer","element","querySelector","data","categoryRegion","itemRegion","itemFields","resourceid","duedate","el","dataset","itemDuedate","parseInt","duedatetype","active","itemActive","Reactive","name","eventName","eventDispatch","mutations","ResourceChecklistMutations","instance","this","reactive","setInitialState","categories","checklistitems","items","componentName","getConfig","categoriesStateKey","itemsStateKey","itemType","categoryModalForm","itemModalForm","selectors","addCategoryBtn","addItemBtn","tableView","getCategoryComponent","ResourceChecklistCategory"],"mappings":";;;;;;;;2UA+BIA,kCAAoC,cAQ/BC,oCAAoCC,OAAQC,aAClCC,IAAXD,SACAA,OAASE,UAEbF,OAAOG,cACH,IAAIC,YAdM,4CAgBN,CACIC,SAAS,EACTN,OAAQA,iCASKO,8CAObN,cACFO,QAAUL,SAASM,cAAcR,YAClCO,eACM,WAILE,MAAO,uCAAkBF,QAAS,CACpCG,eAAgB,8BAChBC,WAAY,8BACZC,WAAY,CACRC,WAAY,iBACZC,QAAUC,IAAOA,GAAGC,QAAQC,YAAcC,SAASH,GAAGC,QAAQC,aAAe,KAC7EE,YAAa,kBACbC,OAASL,IAAiC,MAA1BA,GAAGC,QAAQK,cAK9BxB,oCACDA,kCAAoC,IAAIyB,mBAAS,CAC7CC,KAAM,mCACNC,UAAW,4CACXC,cAAe3B,oCACf4B,UAAW,IAAIC,+CAKjBC,SAAW,IAAIC,KAAK,CACtBtB,QAASA,QACTuB,SAAUjC,2CAIdA,kCAAkCkC,gBAAgB,CAC9CC,WAAYvB,KAAKuB,WACjBC,eAAgBxB,KAAKyB,QAGlBN,SAQAO,iCACA,6DAQXC,kBACW,CACHC,mBAAoB,aACpBC,cAAe,iBACfC,SAAU,gBACV7B,eAAgB,8BAChBC,WAAY,8BACZ6B,kBAAmB,uCACnBC,cAAe,sDACfC,UAAW,CACPC,eAAgB,oBAChBC,WAAY,0BACZC,UAAW,mCAUvBC,8BACWC"}