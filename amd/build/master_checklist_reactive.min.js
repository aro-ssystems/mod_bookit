define("mod_bookit/master_checklist_reactive",["exports","core/reactive","mod_bookit/master_checklist_mutations","mod_bookit/master_checklist"],(function(_exports,_reactive,_master_checklist_mutations,_master_checklist){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_master_checklist_mutations=_interopRequireDefault(_master_checklist_mutations),_master_checklist=_interopRequireDefault(_master_checklist);const SELECTORS={TABLE:"#mod-bookit-master-checklist-table",ADD_CHECKLIST_CATEGORY_BUTTON:"#add-checklist-category-button",ADD_CHECKLIST_ITEM_BUTTON:"#add-checklist-item-button",MASTER_CHECKLIST_TITLE:"#mod-bookit-master-checklist-title",ALL_CATEGORY_TABLE_ROWS:"tr[data-bookit-category-id]",ALL_ITEM_TABLE_ROWS:"tr[data-bookit-checklistitem-id]",TABLE_BODY:"#mod-bookit-master-checklist-tbody"},EVENTNAME="mod_bookit:master_checklist_state_event";function dispatchMasterChecklistStateEvent(detail,target){window.console.log("dispatch master checklist state event function"),void 0===target&&(target=document),target.dispatchEvent(new CustomEvent(EVENTNAME,{bubbles:!0,detail:detail}))}_exports.init=elementId=>{window.console.log("THIS IS REACTIVE");const masterChecklistReactiveInstance=new _reactive.Reactive({eventName:EVENTNAME,eventDispatch:dispatchMasterChecklistStateEvent,target:document.getElementById(elementId),mutations:new _master_checklist_mutations.default,name:"Moodle Bookit Master Checklist"});return loadState(masterChecklistReactiveInstance),new _master_checklist.default({element:document.getElementById(elementId),reactive:masterChecklistReactiveInstance,selectors:SELECTORS})};const loadState=async reactive=>{window.console.log("loading state");const tableElement=document.querySelector(SELECTORS.TABLE),stateData={masterchecklists:[{id:tableElement.dataset.masterChecklistId,name:tableElement.dataset.masterChecklistName}],activechecklist:{id:tableElement.dataset.masterChecklistId},checklistcategories:[],checklistitems:[]};document.querySelectorAll(SELECTORS.ALL_CATEGORY_TABLE_ROWS).forEach((categoryRow=>{const categoryItemRows=document.querySelectorAll('tr[data-bookit-checklistitem-category="'.concat(categoryRow.dataset.bookitCategoryId,'"]')),checklistItems=[];categoryItemRows.forEach((itemRow=>{checklistItems.push(itemRow.dataset.bookitChecklistitemId)})),stateData.checklistcategories.push({id:categoryRow.dataset.bookitCategoryId,name:categoryRow.dataset.bookitCategoryName,order:categoryRow.dataset.bookitCategoryOrder,items:checklistItems})}));document.querySelectorAll(SELECTORS.ALL_ITEM_TABLE_ROWS).forEach((itemRow=>{stateData.checklistitems.push({id:itemRow.dataset.bookitChecklistitemId,name:itemRow.dataset.bookitChecklistitemName,order:itemRow.dataset.bookitChecklistitemOrder,category:itemRow.dataset.bookitCategoryId})})),reactive.setInitialState(stateData)}}));

//# sourceMappingURL=master_checklist_reactive.min.js.map