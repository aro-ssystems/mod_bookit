define("mod_bookit/checklist/base_checklist_item",["exports","core/reactive","core/templates","core_form/modalform","core/str"],(function(_exports,_reactive,_templates,_modalform,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Base checklist item component.
   *
   * Abstract base class for item components providing common functionality:
   * - Edit/delete modal form handling
   * - Event listeners
   * - Config-driven specialization
   *
   * @module mod_bookit/checklist/base_checklist_item
   * @copyright   2026 ssystems GmbH <oss@ssystems.de>
   * @author      Andreas Rosenthal
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=_interopRequireDefault(_templates),_modalform=_interopRequireDefault(_modalform);class BaseChecklistItem extends _reactive.BaseComponent{create(descriptor){const itemId=descriptor.element.dataset.itemid||descriptor.element.dataset.bookitItemId;if(itemId){const itemEditBtnSelector=this._getEditButtonSelector(itemId);this.selectors[itemEditBtnSelector]="#edit-item-".concat(itemId)}this.itemData=descriptor.itemData}getWatchers(){return[...this._getCustomWatchers?this._getCustomWatchers():[]]}getConfig(){throw new Error("getConfig() must be implemented by specialization")}stateReady(){this._attachEventListeners()}_getEditButtonSelector(itemId){return"EDIT_ITEM_BTN_"+itemId}_attachEventListeners(){const itemId=this.element.dataset.itemid||this.element.dataset.bookitItemId;if(itemId){const itemEditBtnSelector=this._getEditButtonSelector(itemId),editBtn=this.getElement(this.selectors[itemEditBtnSelector]);editBtn&&this.addEventListener(editBtn,"click",this._handleEdit.bind(this))}this._attachCustomEventListeners&&this._attachCustomEventListeners()}async _handleEdit(event){event.preventDefault();const config=this.getConfig(),itemId=event.currentTarget.value||event.currentTarget.dataset.itemid,modalForm=new _modalform.default({formClass:config.itemModalForm,args:{id:parseInt(itemId)},modalConfig:{title:await(0,_str.get_string)("edit".concat(config.itemType),"mod_bookit")},returnFocus:event.currentTarget});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{const response=e.detail;var _response$;if(Array.isArray(response)){if(this.reactive.stateManager.processUpdates(response),"delete"===(null===(_response$=response[0])||void 0===_response$?void 0:_response$.action))return this.reactive.dispatch("itemDeleted",{id:parseInt(response[0].fields.id)}),void this.remove()}else"success"===response.result&&("delete"===response.action?(this.reactive.dispatch("itemsDeleted",{fields:response.data}),this.remove()):this.reactive.dispatch("itemsUpdated",{fields:response.data}))})),modalForm.show()}_updateRow(itemData){this.itemData=itemData,this.element&&(this.element.dataset.itemName=itemData.name||"",this.element.dataset.itemDescription=itemData.description||"",this.element.dataset.itemSortorder=itemData.sortorder||0);const nameCell=this.element.querySelector('[data-field="item-name"]');nameCell&&(nameCell.textContent=itemData.name);const descCell=this.element.querySelector('[data-field="item-description"]');descCell&&(descCell.textContent=itemData.description||"")}remove(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}async _render(){var _config$templates;const template=(null===(_config$templates=this.getConfig().templates)||void 0===_config$templates?void 0:_config$templates.itemRow)||"mod_bookit/checklist_item_row",html=await _templates.default.render(template,this.itemData),tempDiv=document.createElement("div");tempDiv.innerHTML=html.trim();const itemElement=tempDiv.firstElementChild;"TBODY"===this.element.tagName?this.element.appendChild(itemElement):this.element.parentNode.replaceChild(itemElement,this.element),this.element=itemElement,this._attachEventListeners()}}return _exports.default=BaseChecklistItem,_exports.default}));

//# sourceMappingURL=base_checklist_item.min.js.map