{"version":3,"file":"base_checklist_reactive.min.js","sources":["../../src/checklist/base_checklist_reactive.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Base checklist reactive store factory.\n *\n * Provides a factory function for creating reactive stores for checklist-style components.\n * Uses configuration object to customize store name, event name, selectors, and state keys.\n *\n * @module mod_bookit/checklist/base_checklist_reactive\n * @copyright   2026 ssystems GmbH <oss@ssystems.de>\n * @author      Andreas Rosenthal\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {Reactive} from 'core/reactive';\n\n/**\n * Create a reactive store for a checklist component.\n *\n * @param {Object} config - Configuration object\n * @param {string} config.name - Store name (e.g., 'Resource Catalog')\n * @param {string} config.eventName - Custom event name (e.g., 'mod_bookit:resource_catalog_state_event')\n * @param {Object} config.selectors - Selectors for DOM elements\n * @param {string} config.selectors.TABLE - Main table selector\n * @param {string} config.selectors.ALL_CATEGORY_ROWS - Category rows selector\n * @param {string} config.selectors.ALL_ITEM_ROWS - Item rows selector\n * @param {Class} config.mutationsClass - Mutations class instance\n * @param {Object} config.initialState - Initial state object with categories and items\n * @return {Object} Object with reactiveInstance and initReactive function\n */\nexport const createChecklistReactive = (config) => {\n    let reactiveInstance = null;\n\n    /**\n     * Dispatch the checklist state event.\n     *\n     * @param {Object} detail - The event detail\n     * @param {HTMLElement} target - The target element\n     */\n    function dispatchStateEvent(detail, target) {\n        if (target === undefined) {\n            target = document;\n        }\n        target.dispatchEvent(\n            new CustomEvent(\n                config.eventName,\n                {\n                    bubbles: true,\n                    detail: detail,\n                }\n            )\n        );\n    }\n\n    /**\n     * Initialize checklist reactive store.\n     *\n     * @param {Object} initialState - Initial state with categories and items\n     * @param {Array} initialState.categories - Array of category data\n     * @param {Array} initialState.items - Array of item data\n     * @return {Reactive} Reactive instance\n     */\n    const initReactive = (initialState) => {\n        if (reactiveInstance === null) {\n            reactiveInstance = new Reactive({\n                name: config.name,\n                eventName: config.eventName,\n                eventDispatch: dispatchStateEvent,\n                mutations: config.mutationsClass,\n            });\n\n            // Set initial state - Moodle automatically converts arrays to Maps\n            const stateKeys = config.stateKeys || {\n                categories: 'categories',\n                items: 'items'\n            };\n\n            const state = {};\n            state[stateKeys.categories] = initialState.categories || initialState[stateKeys.categories] || [];\n            state[stateKeys.items] = initialState.items || initialState[stateKeys.items] || [];\n\n            reactiveInstance.setInitialState(state);\n        }\n\n        return reactiveInstance;\n    };\n\n    return {\n        SELECTORS: config.selectors,\n        reactiveInstance,\n        initReactive,\n    };\n};\n\n/**\n * Export a helper to get standard selectors.\n *\n * @param {string} prefix - Prefix for data attributes (e.g., 'resource', 'checklist')\n * @return {Object} Selectors object\n */\nexport const getStandardSelectors = (prefix) => {\n    return {\n        TABLE: `#${prefix}-table`,\n        ALL_CATEGORY_ROWS: `tbody[data-${prefix}-category-id]`,\n        ALL_ITEM_ROWS: `tr[data-${prefix}-item-id]`,\n    };\n};\n"],"names":["config","reactiveInstance","dispatchStateEvent","detail","target","undefined","document","dispatchEvent","CustomEvent","eventName","bubbles","SELECTORS","selectors","initReactive","initialState","Reactive","name","eventDispatch","mutations","mutationsClass","stateKeys","categories","items","state","setInitialState","prefix","TABLE","ALL_CATEGORY_ROWS","ALL_ITEM_ROWS"],"mappings":"+QA2CwCA,aAChCC,iBAAmB,cAQdC,mBAAmBC,OAAQC,aACjBC,IAAXD,SACAA,OAASE,UAEbF,OAAOG,cACH,IAAIC,YACAR,OAAOS,UACP,CACIC,SAAS,EACTP,OAAQA,gBAuCjB,CACHQ,UAAWX,OAAOY,UAClBX,iBAAAA,iBACAY,aA5BkBC,kBACO,OAArBb,iBAA2B,CAC3BA,iBAAmB,IAAIc,mBAAS,CAC5BC,KAAMhB,OAAOgB,KACbP,UAAWT,OAAOS,UAClBQ,cAAef,mBACfgB,UAAWlB,OAAOmB,uBAIhBC,UAAYpB,OAAOoB,WAAa,CAClCC,WAAY,aACZC,MAAO,SAGLC,MAAQ,GACdA,MAAMH,UAAUC,YAAcP,aAAaO,YAAcP,aAAaM,UAAUC,aAAe,GAC/FE,MAAMH,UAAUE,OAASR,aAAaQ,OAASR,aAAaM,UAAUE,QAAU,GAEhFrB,iBAAiBuB,gBAAgBD,cAG9BtB,kDAgBsBwB,SAC1B,CACHC,iBAAWD,iBACXE,uCAAiCF,wBACjCG,gCAA0BH"}