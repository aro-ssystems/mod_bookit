/**
 * Resource filter component for multi-select button groups.
 *
 * @module mod_bookit/resource_filter
 * @copyright   2026 ssystems GmbH <oss@ssystems.de>
 * @author      Andreas Rosenthal
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_bookit/resource_filter",[],(function(){class ResourceFilter{constructor(selector){this.container=document.querySelector(selector),this.container&&(this.selectedRooms=new Set,this.initEventListeners())}initEventListeners(){const selectedRow=this.container.querySelector('[data-row="selected"]'),unselectedRow=this.container.querySelector('[data-row="unselected"]');selectedRow&&unselectedRow&&[selectedRow,unselectedRow].forEach((row=>{row.addEventListener("click",(e=>{if(!e.target.matches("button")&&!e.target.closest("button"))return;const button=e.target.closest("button");this.toggleButton(button,selectedRow,unselectedRow),this.applyFilter()}))}))}toggleButton(button,selectedRow,unselectedRow){const value=button.dataset.value,isPressed="true"===button.getAttribute("aria-pressed"),icon=button.querySelector(".filter-icon"),filterSection=button.closest(".filter-section"),hiddenSelect=filterSection?filterSection.querySelector("select[multiple]"):null;if(isPressed){if(button.style.backgroundColor=button.dataset.colorUnselected,button.setAttribute("aria-pressed","false"),icon&&(icon.textContent="+"),this.selectedRooms.delete(value),unselectedRow.appendChild(button),hiddenSelect){const option=hiddenSelect.querySelector('option[value="'.concat(value,'"]'));option&&(option.selected=!1)}}else if(button.style.backgroundColor=button.dataset.colorSelected,button.setAttribute("aria-pressed","true"),icon&&(icon.textContent="âœ“"),this.selectedRooms.add(value),selectedRow.appendChild(button),hiddenSelect){const option=hiddenSelect.querySelector('option[value="'.concat(value,'"]'));option&&(option.selected=!0)}}applyFilter(){const allCategories=document.querySelectorAll('[data-region="resource-category"]');0!==this.selectedRooms.size?allCategories.forEach((category=>{const resourceRows=category.querySelectorAll('[data-region="resource-row"]');let hasVisibleResources=!1;resourceRows.forEach((row=>{const resourceRooms=this.getResourceRooms(row);this.hasMatchingRoom(resourceRooms)?(row.style.display="",hasVisibleResources=!0):row.style.display="none"})),hasVisibleResources||0===resourceRows.length?category.style.display="":category.style.display="none"})):allCategories.forEach((category=>{category.style.display=""}))}getResourceRooms(row){const roomsData=row.dataset.rooms;if(!roomsData)return[];try{return JSON.parse(roomsData)}catch(e){return[]}}hasMatchingRoom(resourceRooms){return 0===resourceRooms.length||resourceRooms.some((roomId=>this.selectedRooms.has(String(roomId))))}}return{init:function(selector){return new ResourceFilter(selector)}}}));

//# sourceMappingURL=resource_filter.min.js.map