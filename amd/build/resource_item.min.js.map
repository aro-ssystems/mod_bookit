{"version":3,"file":"resource_item.min.js","sources":["../src/resource_item.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Resource item reactive component.\n *\n * @module mod_bookit/resource_item\n * @copyright   2026 ssystems GmbH <oss@ssystems.de>\n * @author      Andreas Rosenthal\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {BaseComponent} from 'core/reactive';\nimport Templates from 'core/templates';\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\n\n/**\n * Resource item component.\n */\nexport default class ResourceItem extends BaseComponent {\n    /**\n     * Component descriptor for debugging.\n     *\n     * @return {string} Component name\n     */\n    static get componentName() {\n        return 'mod_bookit/resource_item';\n    }\n\n    /**\n     * Create component.\n     *\n     * @param {Object} options - Component options\n     * @param {HTMLElement} options.element - Parent container element\n     * @param {Object} options.itemData - Item data\n     */\n    create({element, itemData}) {\n        this.itemData = itemData;\n        this.itemElement = null;\n        this.parentElement = element;\n\n        // Render immediately.\n        this._render();\n    }\n\n    /**\n     * Get state watchers.\n     *\n     * Resource items don't need state watchers -\n     * parent category handles item changes.\n     *\n     * @return {Array} Empty array\n     */\n    getWatchers() {\n        return [];\n    }\n\n    /**\n     * Render item.\n     */\n    async _render() {\n        const html = await Templates.render('mod_bookit/resource_item_card', this.itemData);\n\n        const wrapper = document.createElement('div');\n        wrapper.innerHTML = html.trim();\n        this.itemElement = wrapper.firstChild;\n\n        this.parentElement.appendChild(this.itemElement);\n\n        this._attachEventListeners();\n    }\n\n    /**\n     * Attach event listeners.\n     */\n    _attachEventListeners() {\n        if (!this.itemElement) {\n            return;\n        }\n\n        // Edit Item.\n        const editBtn = this.itemElement.querySelector('[data-action=\"edit-item\"]');\n        if (editBtn) {\n            editBtn.addEventListener('click', (e) => {\n                e.preventDefault();\n                this._handleEdit();\n            });\n        }\n\n        // Delete Item.\n        const deleteBtn = this.itemElement.querySelector('[data-action=\"delete-item\"]');\n        if (deleteBtn) {\n            deleteBtn.addEventListener('click', (e) => {\n                e.preventDefault();\n                this._handleDelete();\n            });\n        }\n    }\n\n    /**\n     * Handle edit item.\n     */\n    async _handleEdit() {\n        const modalForm = new ModalForm({\n            formClass: 'mod_bookit\\\\form\\\\edit_resource_form',\n            args: {\n                id: this.itemData.id,\n            },\n            modalConfig: {\n                title: await getString('resources:edit_resource', 'mod_bookit'),\n            },\n        });\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e) => {\n            this.reactive.dispatch('updateItem', e.detail);\n        });\n\n        modalForm.show();\n    }\n\n    /**\n     * Handle delete item.\n     */\n    async _handleDelete() {\n        const confirmMsg = await getString('resources:confirm_delete_resource', 'mod_bookit', this.itemData.name);\n        const confirmed = window.confirm(confirmMsg);\n\n        if (confirmed) {\n            this.reactive.dispatch('deleteItem', this.itemData.id);\n        }\n    }\n\n    /**\n     * Update with new data.\n     *\n     * @param {Object} newData - Updated item data\n     */\n    update(newData) {\n        this.itemData = newData;\n        // Update text if needed.\n        const nameEl = this.itemElement.querySelector('h6');\n        if (nameEl) {\n            nameEl.textContent = newData.name;\n        }\n        const descEl = this.itemElement.querySelector('.text-muted');\n        if (descEl) {\n            descEl.textContent = newData.description || '';\n        }\n    }\n\n    /**\n     * Remove from DOM.\n     */\n    remove() {\n        if (this.itemElement && this.itemElement.parentNode) {\n            this.itemElement.parentNode.removeChild(this.itemElement);\n        }\n    }\n}\n"],"names":["ResourceItem","BaseComponent","componentName","create","element","itemData","itemElement","parentElement","_render","getWatchers","html","Templates","render","this","wrapper","document","createElement","innerHTML","trim","firstChild","appendChild","_attachEventListeners","editBtn","querySelector","addEventListener","e","preventDefault","_handleEdit","deleteBtn","_handleDelete","modalForm","ModalForm","formClass","args","id","modalConfig","title","events","FORM_SUBMITTED","reactive","dispatch","detail","show","confirmMsg","name","window","confirm","update","newData","nameEl","textContent","descEl","description","remove","parentNode","removeChild"],"mappings":";;;;;;;;uLAgCqBA,qBAAqBC,wBAM3BC,iCACA,2BAUXC,iBAAOC,QAACA,QAADC,SAAUA,oBACRA,SAAWA,cACXC,YAAc,UACdC,cAAgBH,aAGhBI,UAWTC,oBACW,yBAODC,WAAaC,mBAAUC,OAAO,gCAAiCC,KAAKR,UAEpES,QAAUC,SAASC,cAAc,OACvCF,QAAQG,UAAYP,KAAKQ,YACpBZ,YAAcQ,QAAQK,gBAEtBZ,cAAca,YAAYP,KAAKP,kBAE/Be,wBAMTA,4BACSR,KAAKP,yBAKJgB,QAAUT,KAAKP,YAAYiB,cAAc,6BAC3CD,SACAA,QAAQE,iBAAiB,SAAUC,IAC/BA,EAAEC,sBACGC,uBAKPC,UAAYf,KAAKP,YAAYiB,cAAc,+BAC7CK,WACAA,UAAUJ,iBAAiB,SAAUC,IACjCA,EAAEC,sBACGG,6CASPC,UAAY,IAAIC,mBAAU,CAC5BC,UAAW,uCACXC,KAAM,CACFC,GAAIrB,KAAKR,SAAS6B,IAEtBC,YAAa,CACTC,YAAa,mBAAU,0BAA2B,iBAI1DN,UAAUN,iBAAiBM,UAAUO,OAAOC,gBAAiBb,SACpDc,SAASC,SAAS,aAAcf,EAAEgB,WAG3CX,UAAUY,mCAOJC,iBAAmB,mBAAU,oCAAqC,aAAc9B,KAAKR,SAASuC,MAClFC,OAAOC,QAAQH,kBAGxBJ,SAASC,SAAS,aAAc3B,KAAKR,SAAS6B,IAS3Da,OAAOC,cACE3C,SAAW2C,cAEVC,OAASpC,KAAKP,YAAYiB,cAAc,MAC1C0B,SACAA,OAAOC,YAAcF,QAAQJ,YAE3BO,OAAStC,KAAKP,YAAYiB,cAAc,eAC1C4B,SACAA,OAAOD,YAAcF,QAAQI,aAAe,IAOpDC,SACQxC,KAAKP,aAAeO,KAAKP,YAAYgD,iBAChChD,YAAYgD,WAAWC,YAAY1C,KAAKP"}