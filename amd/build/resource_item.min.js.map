{"version":3,"file":"resource_item.min.js","sources":["../src/resource_item.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Resource item reactive component.\n *\n * @module mod_bookit/resource_item\n * @copyright   2026 ssystems GmbH <oss@ssystems.de>\n * @author      Andreas Rosenthal\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {BaseComponent} from 'core/reactive';\nimport {resourceReactiveInstance} from 'mod_bookit/resource_reactive';\nimport {SELECTORS} from 'mod_bookit/resource_reactive';\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\n\nexport default class extends BaseComponent {\n\n    create(descriptor) {\n        const itemEditBtnSelector = 'EDIT_ITEM_BTN_' + descriptor.element.dataset.bookitItemId;\n        this.selectors[itemEditBtnSelector] = `#edit-item-${descriptor.element.dataset.bookitItemId}`;\n    }\n\n    static init(target, selectors) {\n        return new this({\n            element: document.querySelector(target),\n            reactive: resourceReactiveInstance,\n            selectors: selectors || SELECTORS,\n        });\n    }\n\n    getWatchers() {\n        return [];\n    }\n\n    stateReady() {\n        const itemEditBtnSelector = 'EDIT_ITEM_BTN_' + this.element.dataset.bookitItemId;\n\n        this.addEventListener(this.getElement(this.selectors[itemEditBtnSelector]), 'click', (e) => {\n            e.preventDefault();\n            this._handleEdit(e);\n        });\n    }\n\n    async _handleEdit(event) {\n        const modalForm = new ModalForm({\n            formClass: \"mod_bookit\\\\form\\\\edit_resource_form\",\n            moduleName: 'mod_bookit/modal_delete_save_cancel',\n            args: {\n                id: event.currentTarget.value,\n            },\n            modalConfig: {\n                title: await getString('resources:edit', 'mod_bookit'),\n            },\n        });\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\n            this.reactive.stateManager.processUpdates(response.detail);\n\n            if (response.detail[0].action === 'delete') {\n                this.reactive.dispatch('resourceDeleted', {id: parseInt(response.detail[0].fields.id)});\n                this.remove();\n                return;\n            }\n        });\n\n        modalForm.show();\n    }\n\n    remove() {\n        if (this.element && this.element.parentNode) {\n            this.element.parentNode.removeChild(this.element);\n        }\n    }\n}\n"],"names":["BaseComponent","create","descriptor","itemEditBtnSelector","element","dataset","bookitItemId","selectors","target","this","document","querySelector","reactive","resourceReactiveInstance","SELECTORS","getWatchers","stateReady","addEventListener","getElement","e","preventDefault","_handleEdit","event","modalForm","ModalForm","formClass","moduleName","args","id","currentTarget","value","modalConfig","title","events","FORM_SUBMITTED","response","stateManager","processUpdates","detail","action","dispatch","parseInt","fields","remove","show","parentNode","removeChild"],"mappings":";;;;;;;;0KA8B6BA,wBAEzBC,OAAOC,kBACGC,oBAAsB,iBAAmBD,WAAWE,QAAQC,QAAQC,kBACrEC,UAAUJ,0CAAqCD,WAAWE,QAAQC,QAAQC,0BAGvEE,OAAQD,kBACT,IAAIE,KAAK,CACZL,QAASM,SAASC,cAAcH,QAChCI,SAAUC,4CACVN,UAAWA,WAAaO,+BAIhCC,oBACW,GAGXC,mBACUb,oBAAsB,iBAAmBM,KAAKL,QAAQC,QAAQC,kBAE/DW,iBAAiBR,KAAKS,WAAWT,KAAKF,UAAUJ,sBAAuB,SAAUgB,IAClFA,EAAEC,sBACGC,YAAYF,wBAIPG,aACRC,UAAY,IAAIC,mBAAU,CAC5BC,UAAW,uCACXC,WAAY,sCACZC,KAAM,CACFC,GAAIN,MAAMO,cAAcC,OAE5BC,YAAa,CACTC,YAAa,mBAAU,iBAAkB,iBAIjDT,UAAUN,iBAAiBM,UAAUU,OAAOC,gBAAiBC,mBACpDvB,SAASwB,aAAaC,eAAeF,SAASG,QAEjB,WAA9BH,SAASG,OAAO,GAAGC,mBACd3B,SAAS4B,SAAS,kBAAmB,CAACZ,GAAIa,SAASN,SAASG,OAAO,GAAGI,OAAOd,gBAC7Ee,YAKbpB,UAAUqB,OAGdD,SACQlC,KAAKL,SAAWK,KAAKL,QAAQyC,iBACxBzC,QAAQyC,WAAWC,YAAYrC,KAAKL"}