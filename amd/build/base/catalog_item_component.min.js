define("mod_bookit/base/catalog_item_component",["exports","core/templates","core_form/modalform","core/str"],(function(_exports,_templates,_modalform,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Base component for catalog items.
   *
   * @module mod_bookit/base/catalog_item_component
   * @copyright   2026 ssystems GmbH <oss@ssystems.de>
   * @author      Andreas Rosenthal
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=_interopRequireDefault(_templates),_modalform=_interopRequireDefault(_modalform);return _exports.default=class{constructor(reactive,itemData){this.reactive=reactive,this.itemData=itemData,this.element=null}async render(){const context=this.getTemplateContext(),html=await _templates.default.render(this.getTemplateName(),context),wrapper=document.createElement("div");return wrapper.innerHTML=html.trim(),this.element=wrapper.firstChild,this.attachEventListeners(),this.attachDragDropListeners(),this.element}getTemplateName(){throw new Error("getTemplateName() must be implemented by subclass")}getTemplateContext(){return{...this.itemData}}getEditModalFormClass(){throw new Error("getEditModalFormClass() must be implemented by subclass")}attachEventListeners(){if(!this.element)return;const editBtn=this.element.querySelector('[data-action="edit-item"]');editBtn&&editBtn.addEventListener("click",(e=>{e.preventDefault(),this.handleEdit()}));const deleteBtn=this.element.querySelector('[data-action="delete-item"]');deleteBtn&&deleteBtn.addEventListener("click",(e=>{e.preventDefault(),this.handleDelete()}))}attachDragDropListeners(){this.element&&(this.element.setAttribute("draggable","true"),this.element.classList.add("draggable-item"),this.element.addEventListener("dragstart",(e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",this.itemData.id),e.dataTransfer.setData("application/x-bookit-item-id",this.itemData.id),this.element.classList.add("dragging")})),this.element.addEventListener("dragend",(()=>{this.element.classList.remove("dragging")})),this.element.addEventListener("dragover",(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"})),this.element.addEventListener("drop",(e=>{e.preventDefault();const draggedItemId=parseInt(e.dataTransfer.getData("application/x-bookit-item-id"),10);this.handleReorder(draggedItemId,this.itemData.id)})))}async handleEdit(){const modalForm=new _modalform.default({formClass:this.getEditModalFormClass(),args:{id:this.itemData.id,categoryid:this.itemData.categoryid},modalConfig:{title:await this.getEditModalTitle()}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{this.reactive.dispatch("updateItem",e.detail)})),modalForm.show()}async getEditModalTitle(){return(0,_str.get_string)("resources:edit_resource","mod_bookit")}async handleDelete(){const message=await(0,_str.get_string)("resources:confirm_delete_resource","mod_bookit",this.itemData.name);window.confirm(message)&&this.reactive.dispatch("deleteItem",this.itemData.id)}handleReorder(draggedItemId,targetItemId){draggedItemId!==targetItemId&&this.reactive.dispatch("reorderItem",{itemId:draggedItemId,targetItemId:targetItemId,categoryId:this.itemData.categoryid})}update(newData){return this.itemData=newData,this.element&&this.element.parentNode?this.render().then((newElement=>(this.element.parentNode.replaceChild(newElement,this.element),newElement))).catch((error=>{throw window.console.error("Error updating item:",error),error})):Promise.resolve()}remove(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},_exports.default}));

//# sourceMappingURL=catalog_item_component.min.js.map