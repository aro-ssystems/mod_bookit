{"version":3,"file":"master_checklist_category.min.js","sources":["../src/master_checklist_category.js"],"sourcesContent":["import { BaseComponent } from 'core/reactive';\nimport { masterChecklistReactiveInstance } from 'mod_bookit/master_checklist_reactive';\nimport { SELECTORS } from 'mod_bookit/master_checklist_reactive';\nimport ModalForm from 'core_form/modalform';\nimport Templates from 'core/templates';\nimport {getString} from 'core/str';\n\nexport default class extends BaseComponent {\n\n    create(descriptor) {\n\n        window.console.log('create category component: ' + descriptor.element.dataset.bookitCategoryName);\n        window.console.log(descriptor.element.dataset);\n\n        const categoryEditBtnSelector = 'EDIT_CHECKLISTCATEGORY_BTN_' + descriptor.element.dataset.bookitCategoryId;\n\n        this.selectors[categoryEditBtnSelector] = `#edit-checklistcategory-${descriptor.element.dataset.bookitCategoryId}`;\n\n        window.console.log(this.selectors);\n\n    }\n\n    static init(target, selectors) {\n        return new this({\n            element: document.querySelector(target),\n            reactive: masterChecklistReactiveInstance,\n            selectors: selectors || SELECTORS,\n        });\n    }\n\n    getWatchers() {\n        return [\n            // {watch: 'state:updated', handler: this._handleStateEvent},\n            // {watch: 'checklistcategories:created', handler: this._handleCategoryCreatedEvent},\n        ];\n    }\n\n    stateReady(state) {\n        window.console.log(this.element.dataset);\n\n        const categoryEditBtnSelector = 'EDIT_CHECKLISTCATEGORY_BTN_' + this.element.dataset.bookitCategoryId;\n\n        this.addEventListener(this.getElement(this.selectors[categoryEditBtnSelector]), 'click', (e) => {\n            e.preventDefault();\n            window.console.log('EDIT CHECKLIST CATEGORY BUTTON CLICKED', e.currentTarget);\n            this._handleEditChecklistCategoryButtonClick(e);\n        });\n\n    }\n\n    async _handleEditChecklistCategoryButtonClick(event) {\n        window.console.log('handle edit checklist category button click');\n        const modalForm = new ModalForm({\n            formClass: 'mod_bookit\\\\form\\\\edit_checklist_category_form',\n            moduleName: 'mod_bookit/modal_delete_save_cancel',\n            args: {\n                id: this.element.dataset.bookitCategoryId,\n                masterid: 1\n            },\n            modalConfig: {\n                title: await getString('checklistcategory', 'mod_bookit'),\n            },\n        })\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\n            this.reactive.stateManager.processUpdates(response.detail);\n        });\n\n        modalForm.addEventListener(modalForm.events.LOADED, (response) => {\n\n            const deleteButton = modalForm.modal.getRoot().find('button[data-action=\"delete\"]');\n\n            deleteButton.on('click', (e) => {\n                modalForm.getFormNode().querySelector('input[name=\"action\"]').value = 'delete';\n                modalForm.submitFormAjax();\n            });\n        });\n\n        modalForm.show();\n    };\n\n}"],"names":["BaseComponent","create","descriptor","window","console","log","element","dataset","bookitCategoryName","categoryEditBtnSelector","bookitCategoryId","selectors","this","target","document","querySelector","reactive","masterChecklistReactiveInstance","SELECTORS","getWatchers","stateReady","state","addEventListener","getElement","e","preventDefault","currentTarget","_handleEditChecklistCategoryButtonClick","event","modalForm","ModalForm","formClass","moduleName","args","id","masterid","modalConfig","title","events","FORM_SUBMITTED","response","stateManager","processUpdates","detail","LOADED","modal","getRoot","find","on","getFormNode","value","submitFormAjax","show"],"mappings":"4gBAO6BA,wBAEzBC,OAAOC,YAEHC,OAAOC,QAAQC,IAAI,8BAAgCH,WAAWI,QAAQC,QAAQC,oBAC9EL,OAAOC,QAAQC,IAAIH,WAAWI,QAAQC,eAEhCE,wBAA0B,8BAAgCP,WAAWI,QAAQC,QAAQG,sBAEtFC,UAAUF,2DAAsDP,WAAWI,QAAQC,QAAQG,kBAEhGP,OAAOC,QAAQC,IAAIO,KAAKD,uBAIhBE,OAAQF,kBACT,IAAIC,KAAK,CACZN,QAASQ,SAASC,cAAcF,QAChCG,SAAUC,2DACVN,UAAWA,WAAaO,uCAIhCC,oBACW,GAMXC,WAAWC,OACPlB,OAAOC,QAAQC,IAAIO,KAAKN,QAAQC,eAE1BE,wBAA0B,8BAAgCG,KAAKN,QAAQC,QAAQG,sBAEhFY,iBAAiBV,KAAKW,WAAWX,KAAKD,UAAUF,0BAA2B,SAAUe,IACtFA,EAAEC,iBACFtB,OAAOC,QAAQC,IAAI,yCAA0CmB,EAAEE,oBAC1DC,wCAAwCH,oDAKPI,OAC1CzB,OAAOC,QAAQC,IAAI,qDACbwB,UAAY,IAAIC,mBAAU,CAC5BC,UAAW,iDACXC,WAAY,sCACZC,KAAM,CACFC,GAAItB,KAAKN,QAAQC,QAAQG,iBACzByB,SAAU,GAEdC,YAAa,CACTC,YAAa,kBAAU,oBAAqB,iBAIpDR,UAAUP,iBAAiBO,UAAUS,OAAOC,gBAAiBC,gBACpDxB,SAASyB,aAAaC,eAAeF,SAASG,WAGvDd,UAAUP,iBAAiBO,UAAUS,OAAOM,QAASJ,WAE5BX,UAAUgB,MAAMC,UAAUC,KAAK,gCAEvCC,GAAG,SAAUxB,IACtBK,UAAUoB,cAAclC,cAAc,wBAAwBmC,MAAQ,SACtErB,UAAUsB,uBAIlBtB,UAAUuB"}