define("mod_bookit/master_checklist",["exports","core/reactive","mod_bookit/master_checklist_reactive","core/modal_events","core_form/modalform","core/templates","core/toast","core/str"],(function(_exports,_reactive,_master_checklist_reactive,_modal_events,_modalform,_templates,Toast,_str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modal_events=_interopRequireDefault(_modal_events),_modalform=_interopRequireDefault(_modalform),_templates=_interopRequireDefault(_templates),Toast=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Toast);class _default extends _reactive.BaseComponent{create(descriptor){window.console.log("create component: "+descriptor.reactive.name),window.console.log("selectors in create master checklist: ",_master_checklist_reactive.SELECTORS)}static init(target,selectors){return new this({element:document.querySelector(target),reactive:_master_checklist_reactive.masterChecklistReactiveInstance,selectors:selectors||_master_checklist_reactive.SELECTORS})}getWatchers(){return window.console.log("GET WATCHERS"),[{watch:"state:updated",handler:this._handleStateEvent},{watch:"checklistcategories:created",handler:this._handleCategoryCreatedEvent},{watch:"checklistitems:created",handler:this._handleItemCreatedEvent}]}stateReady(state){window.console.log("state ready"),window.console.log(state);const name=state.masterchecklists.get(1).name;window.console.log(this.selectors.MASTER_CHECKLIST_TITLE);const titleElement=this.getElement(this.selectors.MASTER_CHECKLIST_TITLE);window.console.log(titleElement),titleElement.innerHTML=name,this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_ITEM_BUTTON),"click",(e=>{e.preventDefault(),window.console.log("ADD CHECKLIST ITEM BUTTON CLICKED"),this._handleAddChecklistItemButtonClick(e)})),this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_CATEGORY_BUTTON),"click",(e=>{e.preventDefault(),window.console.log("ADD CHECKLIST CATEGORY BUTTON CLICKED"),this._handleAddChecklistCategoryButtonClick(e)}))}_handleStateEvent(event){}async _handleAddChecklistItemButtonClick(event){window.console.log("handle add checklist item button click"),window.console.log(Array.from(this.reactive.state.checklistcategories.values()));const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_checklistitem_form",args:{masterid:1,itemid:null,categories:Array.from(this.reactive.state.checklistcategories.values())},modalConfig:{title:await(0,_str.getString)("checklistitem","mod_bookit")}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{this.reactive.stateManager.processUpdates(response.detail)})),modalForm.show()}async _handleAddChecklistCategoryButtonClick(event){window.console.log("handle add checklist category button click");const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_checklist_category_form",args:{masterid:1},modalConfig:{title:await(0,_str.getString)("checklistcategory","mod_bookit")}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{this.reactive.stateManager.processUpdates(response.detail)})),modalForm.addEventListener(modalForm.events.NOSUBMIT_BUTTON_PRESSED,(response=>{window.console.log("no submit button pressed"),window.console.log(response)})),modalForm.show()}_handleCategoryCreatedEvent(event){window.console.log("handle category created event"),_templates.default.renderForPromise("mod_bookit/bookit_checklist_category",{id:event.element.id,name:event.element.name,order:event.element.order}).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(this.getElement(this.selectors.TABLE),html,js)})).then((async()=>{Toast.add(await(0,_str.getString)("checklistcategorysuccess","mod_bookit"),{type:"success"})})).catch()}_handleItemCreatedEvent(event){window.console.log("handle item created event");this.reactive.state.rooms.get(1).name;const targetElement=this.getElement("#bookit-master-checklist-tbody-category-".concat(event.element.category));window.console.log("event: ",event),_templates.default.renderForPromise("mod_bookit/bookit_checklist_item",{id:event.element.id,name:event.element.name,order:event.element.order,categoryid:event.element.category,roomid:event.element.roomid,roomname:event.element.roomname,roleid:event.element.roleid,rolename:event.element.rolename}).then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents(targetElement,html,js)})).then((async()=>{Toast.add(await(0,_str.getString)("checklistitemsuccess","mod_bookit"),{type:"success"})})).catch((error=>{window.console.error("Error rendering checklist item:",error)}))}}return _exports.default=_default,_exports.default}));

//# sourceMappingURL=master_checklist.min.js.map