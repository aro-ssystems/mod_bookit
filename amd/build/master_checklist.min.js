define("mod_bookit/master_checklist",["exports","core/reactive","mod_bookit/master_checklist_reactive","core/modal_events","core_form/modalform","core/templates"],(function(_exports,_reactive,_master_checklist_reactive,_modal_events,_modalform,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modal_events=_interopRequireDefault(_modal_events),_modalform=_interopRequireDefault(_modalform),_templates=_interopRequireDefault(_templates);class _default extends _reactive.BaseComponent{create(descriptor){window.console.log("create component: "+descriptor.reactive.name),window.console.log("selectors in create master checklist: ",_master_checklist_reactive.SELECTORS)}static init(target,selectors){return new this({element:document.querySelector(target),reactive:_master_checklist_reactive.masterChecklistReactiveInstance,selectors:selectors||_master_checklist_reactive.SELECTORS})}getWatchers(){return window.console.log("GET WATCHERS"),[{watch:"state:updated",handler:this._handleStateEvent},{watch:"checklistcategories:created",handler:this._handleCategoryCreatedEvent},{watch:"checklistitems:created",handler:this._handleItemCreatedEvent}]}stateReady(state){window.console.log("state ready"),window.console.log(state);const name=state.masterchecklists.get(1).name;window.console.log(this.selectors.MASTER_CHECKLIST_TITLE);const titleElement=this.getElement(this.selectors.MASTER_CHECKLIST_TITLE);window.console.log(titleElement),titleElement.innerHTML=name,this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_ITEM_BUTTON),"click",(e=>{e.preventDefault(),window.console.log("ADD CHECKLIST ITEM BUTTON CLICKED"),this._handleAddChecklistItemButtonClick(e)})),this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_CATEGORY_BUTTON),"click",(e=>{e.preventDefault(),window.console.log("ADD CHECKLIST CATEGORY BUTTON CLICKED"),this._handleAddChecklistCategoryButtonClick(e)}))}_handleStateEvent(event){window.console.log("handle state event")}_handleAddChecklistItemButtonClick(event){window.console.log("handle add checklist item button click"),window.console.log(Array.from(this.reactive.state.checklistcategories.values()));const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_checklistitem_form",args:{masterid:1,categories:Array.from(this.reactive.state.checklistcategories.values())},modalConfig:{title:"TITLE HERE"}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{this.reactive.stateManager.processUpdates(response.detail)})),modalForm.show()}_handleAddChecklistCategoryButtonClick(event){window.console.log("handle add checklist category button click");const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_checklist_category_form",args:{masterid:1},modalConfig:{title:"Add Checklist Category"}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(response=>{this.reactive.stateManager.processUpdates(response.detail)})),modalForm.show()}_handleCategoryCreatedEvent(event){window.console.log("handle category created event"),window.console.log(event.element),_templates.default.renderForPromise("mod_bookit/bookit_checklist_category",{id:event.element.id,name:event.element.name,order:event.element.order}).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(this.getElement(this.selectors.TABLE),html,js)})).catch()}_handleItemCreatedEvent(event){window.console.log("handle item created event"),window.console.log(event.element);const targetElement=this.getElement("#bookit-master-checklist-tbody-category-".concat(event.element.category));window.console.log("target element for item: ",targetElement),_templates.default.renderForPromise("mod_bookit/bookit_checklist_item",{id:event.element.id,name:event.element.name,order:event.element.order,categoryid:event.element.category}).then((_ref2=>{let{html:html,js:js}=_ref2;window.console.log("rendered item"),window.console.log(html),_templates.default.appendNodeContents(targetElement,html,js)})).catch((error=>{window.console.error("Error rendering checklist item:",error)}))}}return _exports.default=_default,_exports.default}));

//# sourceMappingURL=master_checklist.min.js.map