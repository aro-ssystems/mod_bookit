define("mod_bookit/calendar",["exports","core/str","core_form/modalform","core/prefetch","core/log","core/ajax"],(function(_exports,_str,_modalform,_prefetch,_log,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=async function(cmid,moduleinstanceid,eventsource,lang){await(globalPropertyName="EventCalendar",new Promise((resolve=>{const innerWait=()=>{window[globalPropertyName]||setTimeout(innerWait,20),resolve()};innerWait()}))),_prefetch.default.prefetchString("mod_bookit",["addbooking"]),_prefetch.default.prefetchString("core",["today","month","week"]),_prefetch.default.prefetchString("core_calendar",["day","upcomingevents"]);var globalPropertyName;const str_request_booking=await(0,_str.get_string)("addbooking","mod_bookit"),str_today=await(0,_str.get_string)("today"),str_month=await(0,_str.get_string)("month"),str_week=await(0,_str.get_string)("week"),str_day=await(0,_str.get_string)("day","core_calendar"),str_list=await(0,_str.get_string)("upcomingevents","core_calendar");let viewType="timeGridWeek";window.screen.width<=1e3&&(viewType="listWeek");var calendar;const config=await async function(){try{return await(0,_ajax.call)([{methodname:"mod_bookit_get_config",args:{}}])[0]}catch(error){throw _log.default.error("Fehler beim Abrufen der Konfiguration:",error),error}}();calendar=new window.EventCalendar(document.getElementById("ec"),{locale:lang,view:viewType,firstDay:1,scrollTime:"09:00:00",slotMinTime:`${String(config.min_time_hour).padStart(2,"0")}:${String(config.min_time_minute).padStart(2,"0")}:00`,slotMaxTime:`${String(config.max_time_hour).padStart(2,"0")}:${String(config.max_time_minute).padStart(2,"0")}:00`,defaultTimedEventDuration:`${config.default_duration}:00`,dayMaxEvents:!0,nowIndicator:!0,selectable:!1,eventStartEditable:!1,eventDurationEditable:!1,buttonText:function(text){return text.today=str_today,text.dayGridMonth=str_month,text.timeGridWeek=str_week,text.timeGridDay=str_day,text.listWeek=str_list,text},customButtons:{addButton:{text:str_request_booking,click:function(){const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_event_form",args:{cmid:cmid,config:config},modalConfig:{title:(0,_str.get_string)("edit_event","mod_bookit")}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>{calendar.refetchEvents()})),modalForm.show()}}},dateClick:function(info){_log.default.debug("Date clicked:",info.date),_log.default.debug("Date string:",info.dateStr);let startdate=info.dateStr;const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_event_form",args:{cmid:cmid,startdate:startdate,config:config},modalConfig:{title:(0,_str.get_string)("edit_event","mod_bookit")}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>{calendar.refetchEvents()})),modalForm.show()},eventClick:function(info){let id=info.event.id,title=info.event.title;if(_log.default.debug("Event clicked:",info),_log.default.debug("CMID:",cmid),_log.default.debug("Event ID:",id),_log.default.debug("Event title:",title),"reserved"!=title.toLowerCase()){const modalForm=new _modalform.default({formClass:"mod_bookit\\form\\edit_event_form",args:{cmid:cmid,id:id,config:config},modalConfig:{title:(0,_str.get_string)("edit_event","mod_bookit")}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>{calendar.refetchEvents()})),modalForm.show()}},headerToolbar:{start:"prev,next today, addButton",center:"title",end:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},resources:[],eventSources:[{url:eventsource}],views:{timeGridWeek:{pointer:!0},resourceTimeGridWeek:{pointer:!0},resourceTimelineWeek:{pointer:!0,slotMinTime:"09:00",slotMaxTime:"21:00",slotWidth:80,resources:[]}}})},_modalform=_interopRequireDefault(_modalform),_prefetch=_interopRequireDefault(_prefetch),_log=_interopRequireDefault(_log)}));

//# sourceMappingURL=calendar.min.js.map