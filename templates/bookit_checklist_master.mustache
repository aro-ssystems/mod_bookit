{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template mod_bookit/bookit_checklist_master
    This template renders the master checklist with all categories and items.

    Example context (json):
    {
        "id": 1,
        "name": "Master Checklist",
        "mastercategoryorder": "[1,2]",
        "tableheaders": ["Title", "Room", "Role", "Actions", "Sort"],
        "roles": [
            {"id": 1, "name": "Student"},
            {"id": 2, "name": "Teacher"}
        ],
        "rooms": [
            {"id": 3, "name": "Room A"},
            {"id": 4, "name": "Room B"}
        ],
        "checklistcategories": [
            {
                "id": 1,
                "name": "Category 1",
                "masterid": 1,
                "order": "1",
                "checklistitems": [
                    {
                        "id": 3,
                        "title": "Checklist Item 1",
                        "order": "1",
                        "categoryid": "1",
                        "roomids": "[3,4]",
                        "roomnames": [
                            {"roomid": 3, "roomname": "Room A"},
                            {"roomid": 4, "roomname": "Room B"}
                        ],
                        "roleid": "1",
                        "rolename": "Student"
                    }
                ]
            }
        ]
    }
}}
<div class="d-flex justify-content-center">

<div class="mod-bookit-master-checklist my-5 py-5" id="mod-bookit-master-checklist-spinner">
    <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
    <span class="sr-only">Loading...</span>
    </div>
</div>

<div class="mod-bookit-master-checklist w-50 mt-4 d-none" id="mod-bookit-master-checklist">
    <div class="d-none">
    <h3 id="mod-bookit-master-checklist-title">PLACEHOLDER</h3>
    </div>
    <div class="sticky-top">
    <form>
        <div class="form-group d-flex justify-content-between mx-n2 my-5 py-2">
            <select class="form-control mx-2 w-25" id="bookit-master-role-select" name="roleid">
            <option value="0" selected>{{#str}} role, mod_bookit {{/str}}</option>
            {{#roles}}
                <option value="{{id}}" data-bookit-roleoption="{{id}}" data-bookit-rolename="{{name}}">{{name}}</option>
            {{/roles}}
            </select>
            <select class="form-control mx-2 w-25" id="bookit-master-room-select" name="roomid">
            <option value="0" selected>{{#str}} room, mod_bookit {{/str}}</option>
            {{#rooms}}
                <option value="{{id}}" data-bookit-roomoption="{{id}}" data-bookit-roomname="{{name}}">{{name}}</option>
            {{/rooms}}
            </select>
        <button type="button" class="btn btn-primary mx-2" id="add-checklist-category-button">{{#str}} new_checklistcategory, mod_bookit {{/str}}</button>
        <button type="button" class="btn btn-primary mx-2" id="add-checklist-item-button">{{#str}} new_checklistitem, mod_bookit {{/str}}</button>
        </div>
    </form>
    </div>

    <table class="table table-borderless table-hover bg-white rounded" id="mod-bookit-master-checklist-table"
        data-master-checklist-id="{{id}}"
        data-master-checklist-name="{{name}}"
        data-master-checklist-categoryorder="{{mastercategoryorder}}">
        <thead class="bg-primary text-light border-bottom" style="opacity: 0.5;">
            <tr>
            {{#tableheaders}}
                <th scope="col" class="py-3 font-weight-bold">{{.}}</th>
            {{/tableheaders}}
            </tr>
        </thead>
            {{#checklistcategories}}
                {{> mod_bookit/bookit_checklist_category }}

            {{/checklistcategories}}
            {{^checklistcategories}}
            <tr>
                <td colspan="5" class="text-center">no content found</td>
            </tr>
            {{/checklistcategories}}
    </table>
</div>
</div>
{{#js}}
require(['mod_bookit/master_checklist'], function(component) {
    component.init('#mod-bookit-master-checklist');
});
{{/js}}